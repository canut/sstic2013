I2="c598d7cc5b5354440b0613490c45483d4e7b0f6c0368120f10010705010302021209140315081502020305040505130d1102140913040301030304100b100010091604030502040602170b1605160d1004060504010507170e1606100f1700070307010206130816001508120605040204020713081100170d1102020400050500120c130015091701040000030201140b1002110b1103000401070400130e1604170f1404010202010004150e150311091105000401010603130e1407150b1705050204000403100c1701170d1705070204000204100e1101140e1004060202000302110e12071109160401010105040114081702160e1304020402020000120d170110081103010303050103110d1304160a140003070606041509110215091606000506030006130e1601120e12000407010205041009100712091303000002021209110013081603000606020307130a1302140f1507030003030607150f1204110f13070501070702160f1705100b1206060302020406130f1105160c1506040400030207160e1306100d1107040400050104120b160715091402020703040703140c1306170c1400000606040002110f1401140f1002020702000501110b1003110d1200050107000506160a1201170f1405030403030401140d1300100f1006030000060306130a1300150d1706070304030604100c1701170d140205060301030714081206140c160501020006050215091305110b1506040701010005170e1602160e1605000200030204150d1702170e160500050306010316091505100c15030703050601170b1305150a1603070006070500130f1401120c1400040707010606100a1301140a130502060004160c13061309150602040605060410081402140e1505030702010304140f1706170d13070003030307160b1403100c160000010602040013091706160c120104060003020611091305100b1203050406040700170e1105150b1707050105030405110e1704170c170700060404000310081400140d1107020006010606140f1301110f1301000306010306160a1101170f140000000502000212091407100d1703000002060204160f1100150f160305000203010017091204170e1200060002000506130b1702140b1302060701040000110c1105110e1303010700040400100e1702160f1107000005060605170a1300170d120402020006030211081500120e16020707070006110a1400150b1702000605070704116b1255453b004b23467b0f3d0038001f004c580b520f1a4f5d410c440f054e4b580b520f054f09001f0018004d580c520f1c4f5d410a440f024e4b580c520f054f09001f0018004d580c520f1c4f5d580b520f054f09001900544e0b540f0c4f5b4f10004c4f5d580c520f054f2f0019453b004b37467b0f6a036c00000003110c030c1205100a1211081100140a15110c110410081412081305140917120c1207100a1213081102140a15130c110210081414081303140917140c1201100a1215081104140a15150c110010081416081301140917160c1203100a1217081106140a15170c1102100d030c130610091213081204140915150c120414181b1106140816120c130010091215081206140915170c1204100a1712081100140816140c130210091217081200140915110c1202100a1714081102140816160c130410091211081202140915130c1200100a1716081106140817120c130010091014081206140a13150c1107100a1417081103100c030c130610091012081200140a13130c1105100a1415081101140817160c130513181b1202140a13110c1103100a1413081103140817140c130210091016081204140a13170c1101100a141108110100000005140911130c120510091417081205140a16120c110310081516081307140911110c120710091415081203120d030c110110081514081301140911170c120110091413081201140a16160c110710081512081303140911150c120310091411081203140a1614691251453b004b3246110f641111425a45530a001207485946135410440212004b2446770f3a0078411f440f1c441f00524d1a00524d0846184c1a0345081603004b1146770f0f0066174f14114a144f004c164a16114b115f46184c1a03450d011741185216041f004b2646100f27455600544557000613115b161c495b45570a48451c060e004b1746720f1b0035451d00030012004b044942000200060f570f0d000700084e57001301084c52344c43447443000600020f3f0f1a0038581848451c060e001945004f0f410a0352154c2f002f0022001d0008006b1449424440530a001207480e030000021d114345194522004e5861520f55185242444c530a00120748460111540f26452000280033451d00264523003a006600481211425a46530a001207485846075553005c140c440f1c4e0d465d0f0d13500f1655431152415d55004e0c0d545c0a0012074846030c4347450a435b1152415d5500525c44534650005c170b545c0a00120748460906004d4f33004d4424460f394502552d0008101e47180d4e2454094427004e274445572048451c060e00141012491e01111b181509520b410a4f0f00574f43007200000030555300085506550b00555503555300075507581748451f061c00480111460f07131e000607585b151e50065014045d45031748454a430b4f42594308150d0004130c0013030c5d501c12184c1a03451153034f0f00314f5d4d23005b4d114e100006181c00011f1644420d0b02000a0a1200154f5b4d1a00544d5300184f425943171f0b00484f1e54105b4c15441f001c441f004c1658180106130800000010485f4200190b1600505247180106130800000010485f4200054f1b46184c1a0345115307491344420d0b020019451d00524d1a00544d00441f0050524710777065760000000066272822001c4e06491344420d0b020019450f46184c1a03454310044c4c431a4c51105b445b5354440b0613490c4548084e180c50140f110006050305020311505557004b0746180c51150f150006050305020315525457004b0646180c511308160406050305020316575250004b0146180c5610091706050305020312555350004b1d4611195841434441185216041f004b0a1449481c520c1f1048451c060e004b0a154c4a0153031707471c5205021d47180d4e03110e004b16464f5c1f4501535b574e4153560057504449525d5649525d564d43580009001c004b061c454153091d0d48451c060e00171114491d13520d0b0100174556001c5259471c52191207491e01111b18150952054103531f4501535d534d180116534d44000355074c164e5354451d555a001c060e4501535f544e415d5500524e064947530a00120748191300000355074c164e535b451d5555001c060e45015341504e424441530a001207485b534100535b5100111b10000355074c164e535a451d5554001c060e45015341545d004f5847530a001207485b534100535b5100111b10004055421410535a514e535a514e53435600085506550b00555515585248454e5048415257001a4417001e581048451f061c001a45124f0f00575a520d0015100d4a0048001e581b48454e435a00444f5e4c525c4c17000b0019494c530a001207480614545d4f00450d45131150151400000d55124f0f00074f1000020006000e5444444d1941440f094145570748451c060e0007450b41430f0e4145570048451c060e0006450b41420f0f4145570148451c060e0005450b41410f0c4145570248451c060e001945004f0f00575952534544491d1352324e3c003a003900020006003e001f006e00000057550b00494d5042444c530a00120748144606450d451311501841124f0f410a03523c4c5c006c000115115b110600184f4359430b05090057554100414f5d4c520809180055504100535b5100111b1000001a04000d4f164f0f001600020015011400184e06491344420d0b022a41"

I4 = "8ae98ae9000000000200020003161214114555560008555400124e5245114e011d1b48454c430f4540490911111b1815095247515e140110491400004b00010003004a00000056111352425d4c520b191c0050554100464f5d4c520a140f48451f061c00021d17484540430a494c530a00120748080210001c44024f0f000317114845080c1800141a0000494750424446530a001207480c1e1748451c161800494650424447530a0012074858461d4e5545114e495258424443530a00120748110906001d171148451c16180050554100464f5d4c5217031e0000000000494f134e5500525f44425a45530a001207480c1e174845555248424445530a00120748061454144f015446491d13520c160448454b43451113100d4a131043144359430a081a48454a565d00535b5100111b1000001a04005d575042444c530a0012071549001b0f0016000200141a00005840451509000000000b1559501e5b5d1800001119550b00581411415d000000005f410d041e5b41545d5b560100001256184c1a034511530c46184c1a0345585348111452425d4c520e08080054440d4e5145114e08001647180d4e06100c0054440d4e5145114e08001647180d4e0a1b0c005e4f5500414f5d4c525f4c5c00010003004a00000056111352425d4c520b191c0050554100464f5d4c520a140f48451f061c00021d17484540430a494c530a00120748080210001c44024f0f000317114845080c1800141a0000494750424446530a001207480c1e1748451c161800494650424447530a0012074858461d4e5545114e495258424443530a00120748110906001d171148451c16180050554100464f5d4c5217031e0000000000494f134e5500525f44425a45530a001207480c1e174845555248424445530a00120748061454144f015446491d13520c160448454b43451113100d4a131043144359430a081a48454a565d00535b5100111b1000001a04005d575042444c530a0012071549001b0f0016000200141a00005840451509000000000b1559501e5b5d1800001119550b00581411415d000000005f410d041e5b41545d5b560100001256184c1a034511530c46184c1a03455f5348111352425d4c520e08080054440d4e5145114e54451f4544000b001a47180d4e535401445d5649050d120054440d4e5145114e54451f4544000b001a47180d4e535401445d564909061200081707484548435800010003004a00000056111352425d4c520b191c0050554100464f5d4c520a140f48451f061c00021d17484540430a494c530a00120748080210001c44024f0f000317114845080c1800141a0000494750424446530a001207480c1e1748451c161800494650424447530a0012074858461d4e5545114e495258424443530a00120748110906001d171148451c16180050554100464f5d4c5217031e0000000000494f134e5500525f44425a45530a001207480c1e174845555248424445530a00120748061454144f015446491d13520c160448454b43451113100d4a131043144359430a081a48454a565d00535b5100111b1000001a04005d575042444c530a0012071549001b0f0016000200464f5d121652425e4c525d4c0f4f42594357504b004a4f5e4c520809180053451d4e5045114e5045155558005a55054e5345114e5145114e5145114e03000c0053451d4e5045114e50451555580059555900574f4559430b05090050554100464f5d4c52080918490911111b1815095242415d00464f5d4c52080918490911111b1815095213190f48451c16180008101e47180d4e14001a491d1352594e54001d111352425d4c52144c5f00184f4359431f050d00001a0400414f114455001c44024f0f410a035211031c0015171348454b4345111352425d4c521f031c00444f5d121452425e4c525c4c41111352425d4c521f1918491e01111b18150952061418491e01111b181509524341054e5145114e5145114e5145114e03000c0053451d4e5045114e50451555580059550b4540490911111b181509524741054e5545114e54454800010001004a505e505b424f194e5645114e08001647180d134712070f00031711484549431b55530008555100184f4359430a081a484514060647180d4e00111c490911111b181509524441054e5645114e09040a4b4d52525a00414f5d4c525f4c5d0003001c111352425d4c520b191c0008101e47180d4e56541b555300160d0148454c435900464f5d4c52144c08550b0057554200414f5e4c520b191c0051554100474f5d4c520a140f48451f061c0054454500414f5d4c520a140f48451c16180051554100474f5d4c520a140f48451f061c001f0a06004b4f4300414f5d4c52124c0a4f0f0016000200000000002d4f14552d0008101e47180d4e14001a491d1352594e54001d111352425d4c52144c5f0056111352425d4c520b191c0050554100464f5d4c520a140f48454a43014e5645114e011d1b484508161c004155154455001c44024f0f410a035211031c00444f5d111452425d4c520b191c0051554100474f5d4c525c4c5d00414f5d4c520b191c0050554100464f5d4c521f1918491e01111b1815095213190f4845080c18000d4f164f0f001600020000000000454f4100474f5d4c525d4c0f4f425943585054131752425f4c521f031c00000000000d4f02450d45131150150e0400444f194e5045114e54454900594e5545114e1f4514451547180d4e06100c001c44024f0f410a035212181e491d1352594e54000200414f5e4c52144c5f00184f4359431f050d491e01111b181509521a040247180d4e06100c001c44024f0f410a035211031c00130e1c4343285f43117f13534544491d13521b0b06440111130d1d1352190117001e0a505b5e45115b011006130604060b05071143425c500650091f0f004e24175908221659490705410507124f4c2c1c47542c160e544740497c40070e391c5b4f1752140307530e4c040601545108491d465d5d49004f0f001600020000000000000000000000000058000554581a015a121c1a0742411900004e1e4545460c140648454943014e5545114e16000b4506031a091146125d4549155545114e011d1b48450f11015412011d060c1d130f4908080f410a035202000353060a061f006c4c4940"

def retrieve_key(I):
    #XOR cyclique
    res = I[0:4]
    key = I[0:4]
    for i in range(1, len(I)/4):
        xor = "%0.8x" % (int(I[i*4:(i+1)*4].encode('hex'), 16) ^ int(key.encode('hex'), 16))
        res += xor.decode('hex')
        key = res[-4:]

    #analyse frequentielle
    #octet le plus frequent represente espace
    freq1 = [0]*256
    freq2 = [0]*256
    for i in range(len(res)/2):
        freq1[ord(res[i*2])] +=1
        freq2[ord(res[i*2+1])] +=1

    x = max(freq1)
    y = max(freq2)
    
    key = "%0.4x" % (((freq1.index(x) ^ 0x20) << 8 )+ (freq2.index(y) ^ 0x20))  
    print "key:", key
    return key 
    
def decrypt(data):
    key = retrieve_key(data)
    res = key.decode('hex') * 2
    
    for i in range(0, len(data)/4):
        d = data[i*4:(i+1)*4].encode('hex')
        k = res[-4:].encode('hex')
        xor = "%0.8x" % (int(d, 16) ^ int(k, 16))
        res += xor.decode('hex')

    return res[4:]

print "\nk0k1 - I4 en clair\n", decrypt(I4.decode('hex'))
print "\nk2k3 - I2 en clair\n",decrypt(I2.decode('hex'))

