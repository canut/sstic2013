#bac9f7a8721f
import hashlib, sys

I1 = list("cf760bc77db1f282e881ede9a10122b220887466b973b854218b85c230d6733ab459fda9a879973664130312d5ff3e1a8e2f25dc6d3ada1daf6e481438a3a7fe8e36a77e6be0ab3192b6a183e02f84721563b9586d2977335dcdba80530994c097cd054baf0d690ab58e6576c10a6e4d6fd20005621a6ec492bd0d0b3f2fe3709c9e51c9d69464819f111812a14ff0a5ce8c7cf0953d4aca103da4cbe544962226c914dd0d505658963213a757ce8a6063755de62eecd85ce1358c3031d77bee049e6087b671d71eb6239f40be8ceafdbd63a61ba4a87c3770887f72db4711eba54a4f257009729db6cb7369b312cf0781cad85ee7d022c8bc3436cf2f9b2d1b422fd2c07e137af5017b0ae74893e0df3a5cb665cd86715d53215308a34387f28aa4613474d9f8cdc668d3fc1922f3388aee42eb0769a3d4a61dc6ee9314f6bd3c936c38d2bb91bda6032504f3cf46bb7805ebb1a713936012226b2c67705f2d54f281f80c5c60dd0e29bc4e044d5e3261920a29d37ae14b8de9103b28612a93f5ff780be4ed4d5bf2c26e84ad0840870ddb3682b45cfa0126ef3285e343e36d1af40a41917be20dbd2b38fd5ab35913bd06a2e6ec72e61c420d587ebbbd42df622ab863ea45455818bb35ddc3a152b8a8050f6d5885eddd4447d87f60448d86d451369209138a9705ccd1f095cd1893fb23282dd48f9dc3fc4867d3a1832e45e084e54f76ddc3226052af767382df13c0e111805eeb14c6f1a598aff52ac3b1fad9f8bfebd06577e917f5c9096e19222e940129e657b5853e29c1642180a6f937b71a5e5573a387c31899f439d68bd4d26225f2e068ef23660acefae52b9137fee23991daf5758005e45fafae30ec9130adce7be170336cfc1b14bae0a3c28e527b4ef37ad06168ce7efc68d404bc8e27463596e167af4ce4ebcc6a3d6bab1f9b32069fdb5eee73c8f06ebc10ce5120477f3cb04acc7598b0041d59f81792d040d08a0a196c630d1db8f769c144890839394f6456fbb08940c18f7199b23a275bda7592687572448edb0b9c8db2013374849cf5b7381fed20a29b3b00fde7e9847bec41e4f9907482c3198872f077f226ea376fd4e2dd1b1d95a84395d1ddd3cc5d9d2a264c0924803b0299368ed59b2ea92aa515c5b50dd73f950aa1b7d1f637629d721a8d136a5124fc2ba261e252f19de262b292db44705eb66ce43cdbb6bbb0de1b6264e01b58b0faf4c64db7de80d94e57c0c80c61f8df6f1942e560f0cb7100cd07fb42f10855cb3b042f9bb7d0a3ff997ddf70d019d1613e31d697dd65862a144f34a6e413489cdaffc69510dfea38b947af17e15db638c16c2b6ce27716027b8cc3e989404c9005861a45dc85b4597ad263c899830180cab2ec6a43974a56f39e2a705697703851e95fd5c610a588940a901914e5499f7c3fa2969ce7ed98eb7c13741162f322ffa9ae91e21109508f32987e442ffc929a4399b179e923662d365ca26122b1efbe2a5c9b6b5694a5a0af2a859be91aec65abea4f60a6d058f19ef64069152ce31bde73d55bdd4f8d649238c323845e0e3f662b2780ab14304db9e64880830514b726bb788849781d6f151c53c89804f893b2892382f40f1947483d6be6c161de401dc2549de7a4f2b5a6a87f4b787ec1e31c635dc6890cb24b9b8aa3e997375174e686b6e518b23c6850427691242cfad117a60d5eed0801db9de81e6c9b9b4fa02d4ba9a827443c4f77ca715ccd91fc838eeab2324559cc07b12527e4a61cfadc482c6e235c169619b2e98e6e199c7f1ab81d7efc9b91bef810c80892b03e0c42e48ac8e1a60d8cbca21754a8f92c3a3f599210115284f00e222a8fb4e4c10f5cf40f7c26b2337e8428161673225d659adf671ea0e1db3027cf95ecd29559c2850782a92891fde271b06c38c1839ce4ffd70923d426b491765e150500b3a8fabfad44b3998c3527d608438cc0c13ac43327c35059cb4e5d042e88ec8a488c2bdae05d84c9e2eb80dea865d05101a931f72acf49e7a7b9dc7cf3efe6c262b947940fbde21416db0402bb86a3f542e2149322f6175f9b54d329ab051b933c6bf753dea1ccad06dc8fa1f01bf8e7253aca0baf5741ff107f495bfe9e0e46affef5f97f349c447e7ab2c8ba4d22133c99898095f0c75fba756d92aa619b91925463a8b308b6281879c71bde1c24455adaa576a891a2a87b28a6dd99699afeaadeb5e9e8d801bfda817042fbf85ec1a058296c9222967c24d41778f0e2f4d0fbd359e8f799ef75c95765eaf2765d5664b2ea2e8196f1755bc8485237cdd88b81b5f6bff547f352753617618d92a5858cec02f61c34b7de2e7cec018fe86dcd83e6c6e8be1071bc493d98d6edcc9c30feeabbf88ae0e418a0efef015c57a21a0c78df0f89b64103f19fe1118c7dfcefc4775f2c0acaf8a67ccb29a9c8058234e5fdfcb532840a51e464497cdb94c38d24331b0cea8d1dd0d4e8ca141db21cd74114d1200e27909da6c17ae81bcd127be2d78b64f15af6c7d6fdff2a97218368fae0b988c288419ba853dec5b020de9efdd0d60bd1ce8061ab2e4531e1df7259a183bde817804600989f875bece9bdf321624adb63dc787e6c8137e99bcda29699810936bd893c8f2ecdcfbe31bf76c6deaf4dd8e8d24c3d9dcb0ed8965f238c715924a0843db4cfbbaedcb7527368b4e90749a5afc4c9d63dba9fd55f49a3cb4c6a4883cdc9d7fcb3395740ddc80f03a4dc54313d5538df08cfbfa525323fb484cd77d6d441fc857bc23078d137f11a93b4e806da2af6aaf3c2ecde387fee39a03d028185f56ca69fca9b1e23bc66e2c55ee888c82f84b291c79c6cc9b05f2dabc2fd0de32ba8d445264c62933e774bc6970faab310cdbe6d1571f0e2775854a1675763c567a9f17d17149af64b7dd705da1ce7e04a20a7a9bab3b3998804d1bef16c029fd2f580336870f28526dc643fbdeaaa2a28bbea7ca329c691732943b2307d697a2717ca2ad4373549480dda3d377b21382c9d7553a96608ef1d5efd8d05c777c54f28abdecad7a8eefe67754fe1600c746e3617f235eefe6f26e849cd718e6f04f4fe5bc9e609e7168d9dbfae16482ad6ae63faaf4e5040a81f1e45717c3684e9b677738e149eb72ff58c445264389e466d997a808a9f19cd506fa1f60a7ffa66070f8041bfe689fdc69b313d55b5e2898175628e73c79beeebc484f77dd18230caa89d6c43691127bc98b6c832d462d8d4e8725074b771bc98e8584a8296e836cb097a226d1e5554f0d6759625f7ec6a707e8d3712f9e1dc013cbacafece08108deaeae4b772a47b7ff6b672957efaf8f5f1c72a610c7c3deb4c13b2e6962bcd579f7a8f1c964ecf16573eeec1125472621a46e1f540628874ea5548d44c38165fd32f98cdce18e43f1413d6c63e109bba1061e5d39ad820d1b6d539467d0e228742de9aa339ba54a303e482747da9c92bde45567d43873fd79ed624ebd4ef1fa80bc1f88937d58f1bc2f70498bd18abdcc533780076d35699295344da829342a90f6816a3ae8a5b74dc2b598afc3803b387220277731401236c40c16e0327a42bb08c09ee7cb60c9f8ce11f939ea99f51f01adf124798a885ab5015aa1c026abe47c16c25e6e352f176961e768470a0116aa36cf1d3eddfdbc87015759b9852fc935ddc9f36ed7f2a998a6c558e8cd4c43b0f517dac08ae3a72811450b57126acd3dd6609d646928eee71aac89ab020db293e217d6427399f5a0b380d4425e11a6731805df5a4c81a5f39d64bc0e21f1681a58d2e67708fda9cb7639958317d2169d12428105d48b18950a8b291ec4bf974a7a2a06b9b397357d01b959740a6a5dd3805f2d87a6c243d0bda52dcdb1089b80a8c9c303c75a59aa752ff17b27577c5a275664c12c4ca90f898a0a9460e8dab4b73f10b240318e20a0e2a051ff076d5c83f2274875bfa1b936340b7a61fe76386ef75a97f498513579e47330d31b615b6b57c9fd595a52ad130b86da8a961536dbdb15320d56193ac514389ffb3f16b035a3a410cfd4cf84a654045ad3b4826812760a2df1f41fcfe0755faa0f1c503eef176e48a409393c2d86b3f75f42b067a28ff6f3214dc062af78a9c7438c5ef3699fad521d9522e7f08285991a520b5ab7bf38070ad08c8a2ed0dfd8d5b540940d835d0c47258608babea264829cc916f5d2dbf0cc81e2c22400f1fe67ffa8404923de450724c02f33a5366b64a0e09ad5e4652b80661a8c1ee59c6b3259a70ff8ca6c22ec0bb18ec090cc75414340b5878919fc935a1581f6fa1d31aa720cb4185fa098e35bf096609122eb2f91f2ca139775243a16ba937fdc482e06437fadbdb000a87ba6a630f6eadd5f3b2cb4616be497ad9b50673d271539d995c21b41b556b1f238ebf41a40df403632bd289e459d64c84438121c2b80bb87ae521aa0adf5ea24832825e814aadde6b4d34cbff9e58a4b331e85466db0338bb521c3a4f65d891edfc4cc9c86f68537d77b22dd71e77a7f02938328585c5a2e039b37d5d5e3c2f06357a67754854d7316efca09564476ed33ea8196ca493fce197af1abb0f4719d2e503aebed308bdd7034d7c4c6028034cabd7d519aae15bbd12e59509137f99a299e67745e606c7431d0d84de97a1adeb90340fcedfaa07058aed618beab2693925a3bcd17910c0db2eb6c2f4c479cdf058a5d1385a14315294d1d99b9569f9b061110412358a513fa9ca8baa8ee0685db2fa04a4ba2b388d667a1ebc28a77158b6939ef2784796318eef806a027fbda7521de99e42c8a91049a71241068ad349aa45e8372104ffbe165009576faab37f5c244747bb3a9e1766d32612c8b65c393de7ec1cb14cc3927aa41fe5f11ab39405991aafc2fa99c6c3701ee96ab19f79b98d8c18d6ece042e7e5e65ef4b09858d68bf2f42ab32e91413b02ee7a7fc08d2e927fa55b63eb28caf4ce2ed52f0f0a39a989c60d7de5e98fda42865f4335e8ddfe7cbbbb48cdd287e670953230249d5fb460041e251208540c3175844b0d36ecf4112a9bd88ed6a9313f184e2b2629af9d478434f2b1fac47e93906c9c0ac832352e38e4dff1ec5e5cfbaab538a3ff4a43fb5d812ccfffc09f9fa841cca5b9c91e6cb8b9bc9886194bc4c93ec679cc8abefd6e9de72483e0ed2f8f3105d270b6923ec3bd910859afa56d87c2d5b4556fd9621682aaf2aeea206ae4a81440617b5a023ea424b6549c08337edf64d3ab6f7ee7169d83df7feeeaee00c69ab0804ca79c928014c2946c10a0dafb6b3e3d4494f064015fb306f5532730133e596e3189d5bbdef11d29eb2f8268558658497957a47560e247c0a81717653918094382750ba79c6e2bae666daa648ba8cf191a9d431c7f129fbb6fa231bcdb671d08b137107339cc6ebcad15fe6f30f09348eb9ccc3970302e8e1f2701a3cb4cf9e5246c48dc509d7020ce462a61580ac2ff82b3a62ff6e5d64ddc4f85cb2c7c79d41939043c66e2864c3e733b718bd83b187aa8cfe490f6c8234f9977a1a6edf3056bb9646591f1ce75337069f827b1dbe69d842306210e8d9a9edcb971d88c31672485a4045e3f357947129d83d59cbbefe9049dd9ce45c1f9f42bb6ba49afb207f6a66078a267c498b3da273640c3ad0cf112cea4729edfb0e2554c91387a44fd5f8a7bec6a0faeb9bf795c0ba7bbc749572edcb17192889f481b2b8f0c7ee2df42eca20b487de6413e35c618d3290a95bd147654300d14d7902df801e1156963c3ad71429f122256ecb788ec3b345fed6498bdc3d73e46fb89f5db7ac0c774a0c1c293c81ebff545f15ed50a9df5fe63a012f80c741008c44911977fd73ff5a2d61c0a99a75206fb1ac52f6a7f5e946d6dda4b642dfbb3e8894209e6877fbaef84d500bffad9a294615aba3b86e9d3b0efd09940e85b9712339bf043cd3bdf609e68a9eb157b1088eacc8adee3f179c1fd66309cf5b98d6710c812793fd526c6ae8ab9a87b31bf8e8c9815c280feb0f4fc864f41ee44345ee8b8f081d88d4bd14123e11c0335962be1265e4c5f8a5e215e73172534f78219ed3b67a205b78f21444866081e9b1c29f1fd4bd496967f239d622ba4e24e1259e52325f95d1f45df36b5193cd519d9d2aa4beae0cc2655ac56d0be0106351513862eeb043de82eedc8ceec5e400b0dc729bc916123446c9d94fe8a4e9fa43af7104e5e1919f08dbc349fed7c1a041324fe2e0f2fc4ba0009532dd9efe5894a7f643181d3afeedff5073cc21d7726c2eda750348debfae879855b39eea610a26fe7f34b0140fd69ace2ee6a9898c28d3a36d8ffd076a29be92f180ab1f81d75c40470f80ff2db31d26d16fb50aefbebd7a74dbc0afe60fe9c2258804324007c6deee863cb843f49e871a7823c581a56246497fe6df06f467d6b2bac465439d5fabb8c18c3e900e12d97f103c34d60e7ca7b679e3dcd70287bb16d884bb351f92f081f9199e6620bb7a63ad985372c0940af87e70301387de96c8c7e2bc6292c248fbec5f736d92f8c31fd92aac224d0bba00a12bfad0c9813d1b76482641aa2f13d7668b36d13f60979c3ffe0c9303b45fbd1b850f2e3da454c796b5dc1b387ccd9b43e868d3800da44f00d0557106f8d8c5ddf0af8b1df122f96ee26b9e860c3c993a84ae477fa3e131c272eb42d19acef3c5cbc28b5e26109a06be420422836c17d69b0e64f5722bcfe9d89d5fb100c8318b46f861834e8bb51ce51261a32439dde684b8ff305e5b5f7e1d152d4311e26e9a59b44c7f009b1941851c9ba3ab8424020e520959ed5ec1eea67d4bb510c916a592231cf99f16111b95870fd616522d609fa67053762591840fded0480a7cffc819224aa7eff4a5b3d8eadb28732e63a4c76b9d53296294707d49c3f9edcc275a18caf6fe0eac7d92733901f6800cd41bdda04a87cb03caf5d72bd762ff66c331d158ce25b8b25ddbdd1e9aceef8d18576ff215cc32f0a951b479de8223140582708991fba7afc7d3e21637ad133a028048537b2977a47c38a60c6e96176262eafc044b5a97543de0122ac679e2e2e03794bebe2006c660190e93466b62f5d53f57dd5d5528193d5e57fff8de11b265da9a45d432b03af9d6aeca3585d0d073b9ad68f791a8a51f2258decb4e125bacfdece6e4195ca5be9cc434838191009ba6342b06b19120215d7e6609720e5fd9c355ffd98ea552f6f8336fb8f494d7d79a935f2cc871b4dacc8a3173e865cc33a5ae3c1235775f25ffe2a03f17a81eca9c824e6261e99a7cb856911217c620a35ee042678f5f512177e7673ebd3630ddd380d891912d892f77d59e132b3cd42f200f8ad664ef5d2386f58b6389f8a90df7de6149195993e7b26eee2f42b8ec8aa6f0dc8cc7daad72c0d5a323ffb2195e81f549187b9f13775485250aa26589cf9dbca10a4b5525fafd3446c0478b751c65bf187f263c2f65f0c84f3d73966568ba248ecdaec2c8f94e4a214cafb46adad6f6f0c3501463217dd833fab5589493e80526d521bd71e6ac5449032c56330457e8cde470e49d08348e5484b05ef45378f2c71100bd8a45baea94e5fb2110e975544e57bd086662903d13fb8361634fc885beda70396b0f2ae99cd72e44db87eff89938c41f5d31786cb0910b5eb108f87e029b1fd3f2eddff44069cb65af631dc8efd882f726e85a3a465256d68216b1fcd8880f963cc51c5a7ee010c2bdaa2240abaf6adf35f6e351dd9620657c31f17340e92864707efeaccfdf5be205e016157ec32fab122934bc36d56dec77a22b9b5be4b8a80acb74708c9aa2467e7a1173696942d877566a88972026f9fb9766a195b4c9b703fa1d53e196cf8aec9402a1f35d1c9a4a8d8a7d18a16227dbd19bb2acde33578f432939c14f3b3ea9e10f9be1ef35ebdcc961bb73aba30b05e7bdf3e2100e063b7ec16cbe34e2b57dceeac7f2299da8398a860c3b6ddd38ebe43ead208ecc30e301763553334194632b905130decbfbe2481e16e3691483d8999dd295a3b96d23fd4ce97238570bbf1899355a2926f09ce159302019f9300d47fc6b545eb64db673ae61a6f5917da55e4edff628d5595f4827ab183baf00c38abfe508b7f0679c5e1227b179cc94f1c71c9bec11aad0533d1465c563996c7db2022e66baafffa4007b89cfc62523d2f6be3398aceffe4570830eabf91e4677718387fecc3f290b387bd13ee8fc3bc4f000a5a0cf7e96dee14fa08af051dc2c4506a8a7d14bde5cb78e20518461d5abc91a848b5942f5f057cb9447514f4dbb0b562f2d1f283a62d0ac968c9e08f4e01912bb52c10ed1cc38c93cc835a63a5152f08ee8efa4b72592433662faf5386c699d33a43329a7975deadf48efc1d840dc9709811bedd46666709374350dc21d0391d7ddbb1dfbf3cd17528b8b613974d8c969f127a0ef687f8665290c4ba8785fddfd8ce510b797430e70dcd385d8eab03c893cbfedf4e6992f4d3493fb8f0c9f247e7b114e979af1f866a47bed199e2231e05f3cfe2c5d3410f3d313a0c85c7b3ddca38e29d0f9a9ce3fc9819175e76baf10bdac131d4a36ecadfdd8b63add542a21149721b141cfff3c649bd3eb342ff795e5df075808bf66181d9109be15eaf784538e4fba98c0b455eac07a2e8dad57eefed86ba1255f5ac4f7562ebfe2e98b3c15fcb94fa24a337718af0b478d3445aa2e24842fdfe3d2d9ffced0df6ce5da358f1744df29fe202a9b3f4acd7266043ee3460324a176efa2ac3d0d7f76879b105e5a0b77c068d431792cb238fc437d16e2a84452fcab4a5cf606ad0c4fcd76b65e38d01a409afe59e1117a1110ee01e7d3dae7de6e0d49d0c920accfe40d061e61a912da1eaeb457ffcd6cf3152addd29163c82a2a72baea0956430e07e055ad6c97e8d82af183358f58fde77e3e33ef0b119482106e4563924b7d9283c9d9911eb9b5d9dce86d3afe0869077ea96d6c60fd11d37a3f7da1483f80afcbabef636e0820a09371c7556a16eb525922bafcfa95720d6866620ff20b2975b6ee19d782394cca7335b65e714ce30833cea5eb9f212ad2b4c94905335ebda60dfe6e611d2decce9b4f7f034e760ea8d987b708f000f39bf089f44218fc8b2a7ef6575beba14e62d2c8663a9cb932c62ad3df02cab55d3b2c8b4bf3507771a2e4d229a37e4fed4d78f4e23eeef2497da664c7665469f1b682c933e0d322a830bcbf239ca58a2fa41715e92c3c7083e8b56d23c2cdf3d96d126dff16538b2720cee4b2e5177c6e8c49808edfae722dfc2ea0a7285e7e7dee4fa342e919dd05204ceeed920bfee6b062f4990d614d84929416480c9d7749760bfd3939796ff68beab815c1d4e7b5676b31b195ace2ed5aacb8050a52b7403e3b31a2e6b94144cde7d9f32faff47f043922b46cd49505e010dd1489161b2195ded57f9b2d75e30a6003ff65e15d5286b9dc1c3f60ca0c8417b8892dd73af19cb1efa2313272a4257a1e25420310963661c01374788466916ee2bdfb417633d3fa84665513e19351d15a116f2027c5044e1a5129031d9aa6030803ec482c3c1702b378572c92fde1cce2cf0b3f6b18f14c8b7d91f628b30191047f9f75f1e2dd90bd16ab0590fd0ab82267b30f2d81ae8449ed727cf288ed27e51304abc75a569422f6bfb019318e319a05d7839e5f3ec313d7e356330a4c0b90f287a57500a34175081d0361adb6801e2bacc98f74e30bf465b5f05f24e442b10cd175b785437810f8f7e6d437f2d7a1bdfbda91d4562a5679452d412bcddb27e7851e7e681e0a718a60e31aa5933ce4cdb48124b6a98cd71c562cd727e2accafb254740c2c4e91e80f06bc107798cb09b1f9403c22489e82bb4b46bd73ac2d6c0456a0f2a8db57f500ead3ef0301aba8141764ff4f5cfe3d0e4d3ba7bb9d640c3cc343752794c79cbd388bc51d6c53d01a68455f202831b887711f36ed2936119f8a873bcce6576c59e9e901523432b5aee3761e85b59725b07cbe90a4213a6c634f08d06bf3e5a2f5e0d0ce75f8266af9836549c4bcaf08dad516564b1614b5a01afef394819f3a2fdb16956a1ee2b20813cdbeb1f91a008d3251efcdfa78f2ac15305a16cbfd68bed6bcd3a79b76f96870ef613da6968b8d04bf93a8fb243b0da28819e9a2580064d0438dab2c73e35532990223d6c5aed7a3c1657f878981069e1a8a8636028d4c59565deac564713a6902bf7044f26c861da74fa94ed19853af391440cc7622685aa98f32892e2f307ce841f7bc4b9dc6e7e5c794898957397c5aafcb5baf97b58ece75bac9a9e407e68efc908c467a852200316ceb6431e4a0cdcd3f02d74fc6edc8930a99fdd0fb5b2a1312f47abfafe8a5a46afc485417502d1da903f301e6497aa92fc7cf03e2fea078583c5d9d5bd01db78d5c60855f1f9dbe8eec2a3bf05a19e1133e82930fb16388c07155777ab5b22eb240891b24e4e5691aacf6b195ac53a24f6fda565ca91b86b6261d1d8a5951de311d619954f5a81aad2646f4ce421f395c15a14424c1aa014496377a57be14cb23796b89772ad9cbb246555c11282341f18bc3ebf1de5eb87985242ee77afc40254f1eca0d940d4ea68c1b7c9186057abdf8c530e4373c2deded9ca8a9700115773cb75df63f92562e456c15003cc6135e798d022544afa2e3457b4d5d7cb22496b31d6b57da7abda0c0d493be7a0a41e54f56bb4e35082b9f628878c1c6efa1dd9383e2ddf3c98f1663a515f8ced717f72101382ebf68d89feb28964998dc622d74d7c83fe882ad99143538f864d694ec250948d9e64eeddf10703d7440c8db989f0c70a70a03f1d79821d834cc2aaf138f21b52fe6b75ac643f27205eea9d5707e2f282431f8920d49c6d9ec4c9c89fe016b93c5635d662e59a3a7b339be93df0432f7dd0ef4aaed64b4da9b68305f6d30e91bc1764d6d18243908dec1cf5393fe670425f52d9673b1765acaba2e80c026d6491f409d555e054b0326f420a5a382250f6ae8c07b34054afe922502469c7a992cea70a1bf451f5ccb00056a79ba02aafea02e41c4cba78fbd113902d23f02e015fdef8cd7a61fed8582ac4847be2c933162508e78dfdddf702dcd52122dd836e1a503e22091a9b95f14af4804c300ff8c408cd1b043e3651b9f33489503dbab0c18e3b6cba35431308a19fbcc45723cfd6d8d908870413814fca496d665b42ea121ae68d31a5efdee5a8945053ddba81ba40e03114628823a21d73b5ca3d6049a451ddd74257b66a482f1ba0080913cabb9744b9824c775b6e5b2a7ac1690e461863edaae8ff417cf307f13018a80a1675d6ad18ff3f209facdc53ceb9e3792556be99ecae0bbae3cc3961858c8a24ba87508ce4ad8f92a5bf45f8278fe4af1ba4100c11e55c64d95220c1f6bf857d9e1bf6ee24c368725aad49ea0c08e30bae076fea2b005c9c156beb04f1cda304ff137a5619cab8a0e6db389ffc4d6b7f7909069956492e6631ad5746f385a60f6de4c432e64e11b90f5eafdbf603db7a0f3aaa1d7f85e64e6679d0d90cc0335b9b17d5e8aefc6ceb33d3d4b65688c8c19efb793528b7079e3cd7cedaa947bdf683d778962acfba0a78c71034ca60309dfc3e13d8575c836a1c99e3ded7a83ee405b7bca8f0ea650f7b3bd1eea1ede8b0f3ae1fefccf94ec811685b807fcf1488f592d089aa06f8e4e76c1fc944c662c88bd5199e77dc4660c2957e6e738049c21e2c7af95ba122c6deb90c6a7006116f8c9cacc1f0fefdeb782b40436fcd00daf589509076dde465b72e3b2311382781b598cbd51ac9f59c33ac731e6842dac85d50b496b7dd456d1ccbbc10c54c6b21c52f34181875417aa69a00cf1154d88698524ab742be1bcd85f2bd8a75fd2c11c35e4ec427e3e283518cb3471407deff97aef8f63cdf7290b8a984875a4015124edb69a29559f45074dd77682e49dbd41d46334dd1c742a2110af744f06b84247dc6e5eb2b0d392157a10fc8652f8a0986f7be7efc43ee49b906baa6bbbb37b9ed4547c52e40c4a54a68baa706c0d3f1c8bb98b9056abb2c215ca4129c912a21976fedb11d05807e743140556b7d08b4c39fb9c64b9200f71391f0089e0643e1dedb7f086956d684d3a34202b185f8db789408d35340079605b89a2a0a86b23477d6df3e3e0382bae92a8c65cb75fb29d27416b3ccb9b0553527daf8dfde2cf91c079c9a98561e9ab7df319a15362032b654a60b86a4262cd1f331ff6e99b459ebf3babd86f3e67669a6510c2d7a4579a59e33b8a70fad65f1f0ea52fd1a92a88dc5719d3ccd385bc1dfa50d881c42073d6be35ec288e0a184a7ed2bbf7985ed577fa17db00fcfdb5c515c259b4ddf755cb1a8b4c93a2ed3411692420aa5ac985336f180a1ecf343f3381b2893ee10134a0f9dac32f003c78baf71c5ecbea32621dc151b6deb709e12a484363c9d3bb586d769c9e3dad47cc8e4d1bc0946df227db84845a518663239509396d678dbb58981704c119ff286c32a8136037f4e561f2b09fe0ee47cba1e267fc28a9f2d1774e47cb0e924cd8f002aaa094687a0f9cb6f45a998f7038a63b518c01483ee17ac95f319c4d49ccc2bf3a01d5d4b6e706c3cfca37b2ced83985bbd82901cbfe54dd407c7f95ecf0e4e5fd563c2d8a68d159c7c71e39422576339577c657c9f2e91af65d227509226fee6cb08aa0878da60c29e510ad63ad9d0d48b92821ba70b5be8108a648cf18bc3dc4b18725aed7dbed392be88eb3d8d889de71b450ac5e8ccaf893424c929dce5515486a27d836aac2e8965a3687d41ca7bb709702fb711bfd1a136bf9f4615ff97b74469520aebd1195b3277d8ebee180178987a2d7be5d577fc854f657d6df8432f32b4273fe2f370d198320f7a8574585304c8d9d67fa8140b46312649e99aad1ea730e2b116cc1950eba5612921fcd48d2e0d237eb6752082c3f1a4b11cd6c414c3523226cf16393c2089c64b6170c241b08d45b0ed83c262858788561ae97d86b35db5d4199e615b4b81b57436ca041629ea77fd6c7ffe58599b2aebcd3198c5410c3789426f4aacccde46b1ed689205292f58eb8c9912e52e78d8202ee290878f0bcc3679a88551f50f36f1d5f212bbee3564cadd338dbc4dcbcdb489114061b9129863c9c121dbea51d560d80c1bef2b8b1ce31b7b7a28c1a87502327435969ae95031077669b0b9ee7d6902ab76a776b0c95d60e78d6b467d908062a9e0e1b1dd1535331c78e4feb8a01666814494c2ab6e80d4d3adb21b79aff0618c17ba36b48a2a3565537f8639f922099ca8dfd3752006492397570b5e56298502ce7b4442881a76a050b27d2d642a33812e1140ce756d34c856f175439f4a1a39dba22da36326c0aae9176582b2968f565680577216b9b6c9de9a4f72843120760c68cc9b7aa42ce705ec3b3e6da2d0eebf1ac983af9669880b9c9f9acee34760b738081572fc9ca8905da4c8e904fe8cc79fd9472a61506e638873ff5eafb91e60a4f8309291d5d49f45d5c7eee02749f88abc5188415eb1cfc68242a08ed8a325c6f461a12eb13753cdca0810e5500b0b9b49cb2d0a7f754f69b62da6ed3f56bcdcf8a68b7a616cf512cabbf1935cf858818858266fecbf422863d3565f9c5bca95390c55807a6881a4454808dc30491e614d9254078830d00cfd006638e6ae143164b388ff8073a5537fcc58360e383447ca9df67d58d14f8f74949ce31dbb0ddf14120d84f8c4f567750fb9fabce73ca07d5d6b1e7d1d9e7ddd516de6052d2ea3ff07a7a785e2f60e446cea06c34bc5619ff26a3bd58b1a3830b038926920c24b9ee83fc3be7faead0a46b88a6d76e5e342fb87eeac7b11421a77524f131f9acb92db510606129deca41026862c520bbc1f82fece681d6955477ac15428c16d5097a9121359b85c58f".decode('hex'))

I3 = "338f25667eb4ec47763dab51c3fa41cba329e18536b83159b3a690a0265ec519aae94f0e715376c4f087bcccdd0be3b4a114f8be746142c44978faa76dae62cf197d7bce4eb38dd68c8ce5f69f326e1effceae3f72f8eaa38e019a59b1dc0997"

def rotate_key(k):
    return ((((k >> 3) ^  (k >> 7) ^ (k >> 2) ^ k) & 0x01) << 31) | (k >> 1)

def compare(k):
    if k < 0x55555555:
        return 1
    elif k < 0xaaaaaaaa:
        return -1
    else:
        return 0
        
k = 0xf7a80000

def swap_xor(I, x, y, a, b, k):
    i = x*128 + y*4
    j = a*128 + b*4
    temp = I[j:j+4]
    I[j:j+4] = I[i:i+4]
    I[i:i+4] = [chr(ord(temp[o]) ^ (k >> ((3-o)*8)) & 0xff) for o in range(4)]
    
def scramble(D, k, x, y):
    for i in range(10240):
            k = rotate_key(k)
            a = (x + compare(k)) % 77
            k = rotate_key(k)
            b = (y + compare(k)) % 32
            k = rotate_key(k)
            swap_xor(D, x, y, a, b, k)
            x = a
            y = b
    return [x, y]
    
#final_key = 0xbac9f7a8721f00000000000000000000
final_key = 0xbac9f7a8721fad3c9fcf271eed9abbc8
I = I1[:]

x, y = 0, 0
for offset in range(6):
    init_key = (final_key >> ((5-offset)*2*8)) & 0xffffffff
    print "\nStep %d\nInit key: %x\nx, y: %d, %d" % (offset, init_key, x, y)
    if (init_key & 0xffff) != 0:
        print "Step %d done !" % offset
        x, y = scramble(I, init_key, x, y)
    else:
        h2 = I3[offset*32:(offset+1)*32]
        m = hashlib.md5(''.join(I)).hexdigest()
        while  m != h2 and init_key <= (init_key + 0xffff):
            J, u, v = I[:], x, y 
            k = init_key
            #print "Trying key %x" % k
            u, v = scramble(J, k, u, v)
            m = hashlib.md5(''.join(J)).hexdigest()
            if m == h2:
                print "Key part found : %x !" % init_key
                final_key = final_key | ((init_key & 0xffff) << (5-offset)*2*8)
                I, x, y = J[:], u, v
                print "Final key : %x" % final_key
            else:
                init_key = init_key + 1
f = open('output.bin', 'w')
f.write(''.join(I))